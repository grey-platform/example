本文概述了如何编写grey所需的文件，使其通过编译并输入helloworld。

首先，在git-grey\tools与gitgrey\grey\win32下有两个添加环境变量的.bat文件，分别运行添加环境变量。

接下来，以在example创建项目1_helloworld为例，先创建项目文件夹，进入并文件并创建 bin 和 temp 两个文件夹。

之后创建代码文件，修改文件扩展名为cpp。例如main.cpp。

打开该文件，先引入两个头文件：

#include <include/apps.h>  //MAIN函数需要
#include <include/stdio.h>  //printf函数需要

按标准格式写函数的主入口。如下所示：

int MAIN( int nType, int nParam0, int nParam1, int nParam2, int nParam3, int nParam4, int nParam5, int nParam6, int nParam7, int nParam8, int nParam9 ){}

暂时无需关注MAIN中的函数。在函数体中添加下列代码，使MAIN函数整体看上去如下：

int MAIN( int nType, int nParam0, int nParam1, int nParam2, int nParam3, int nParam4, int nParam5, int nParam6, int nParam7, int nParam8, int nParam9 ){
	switch( nType ){
		case EVMCT_Init:   
			return 0;
		}
    return 0;
}

在case条件中写printf函数，并输出helloworld。最终代码如下所示：

#include <include/apps.h>
#include <include/stdio.h> 

int MAIN( int nType, int nParam0, int nParam1, int nParam2, int nParam3, int nParam4, int nParam5, int nParam6, int nParam7, int nParam8, int nParam9 ){
	switch( nType ){
		case EVMCT_Init:   
			printf("Hello World!!!!"); 
			return 0;
		}
    return 0;
}

注意：此处需要在已经创建好的bin文件夹下添加一个config.xml文件，结构如下：

<program>
    <appname>helloworld</appname> <!--app名称-->
    <taskname>helloworld</taskname> <!--用于特定情况下显示app名-->
    <developer>dodobox</developer> <!--开发者-->
    <descript>test demo</descript> <!--描述文字-->
    <versioncode>1</versioncode> <!--版本号-->
    
    <model>console</model>	<!--重要：可选模式 normal console desktop0 desktop1-->
    <heap>10485760</heap> <!--为该程序分配的堆大小-->
    <stack>4194304</stack> <!--为该程序分配的堆大小-->
</program>

除<model>外其余暂不需注意。因为代码功能是控制台输入，所以这里要设置为console。

完成上述后，将tools文件夹下的build.bat复制到项目文件夹中，使用文本编辑器打开，需要注意的内容如下：

::源文件设置，只需添加要编译的文件名，无需扩展名
set sourcefile[0]=main

::程序文件输出目录设置，设为bin\code即可，
set OUTFILE=bin\code

::包文件输出目录及文件名，后缀为.epk
set EPKFILE=helloworld.epk

::系统包含目录设置,请按项目位置修改路径
set INCLUDEPATH=E:\git-grey\gdk

::设备文件目录及文件名,请按项目位置修改路径
set DDBLIBFILE=E:\git-grey\gdk\lib\drive.asm

在该处设置项目的相关文件路径配置。以上配置了example的1_helloworld项目所需的文件路径。

运行build.bat,若参数配置正确，会看到当前目录下生成了.epk文件。

然后打开控制台窗口（windows+R键，输入cmd），使用cd命令进入 git-grey\grey\win32。例如：cd E:\git-grey\grey\win32

进入后执行命令：gray -start *.epk文件的路径*，如：gray -start ../../example/1_helloworld/helloworld.epk

若一切顺利，则可以看见HelloWorld正确显示在窗口了。


